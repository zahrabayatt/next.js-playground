import type { Metadata } from "next";
import localFont from "next/font/local";
import "./globals.css";
import NavBar from "./NavBar";
import AuthProvider from "./auth/Provider";
import Script from "next/script";
import GoogleAnalyticsScript from "./GoogleAnalyticsScript";

const geistSans = localFont({
  src: "./fonts/GeistVF.woff",
  variable: "--font-geist-sans",
  weight: "100 900",
});
const geistMono = localFont({
  src: "./fonts/GeistMonoVF.woff",
  variable: "--font-geist-mono",
  weight: "100 900",
});

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en" data-theme="winter">
      {/* for google analytics, the script should be as high as possible */}
      {/* instead of script tag, we should use Script Component from next.js */}
      <Script
        async
        src="https://www.googletagmanager.com/gtag/js?id=G-E720JHXSJ2"
      />
      {/* next/script components with inline content require an id attribute to be defined to track and optimize the script. docs: https://nextjs.org/docs/messages/inline-script-id */}
      {/* Script Strategy: https://nextjs.org/docs/app/api-reference/components/script#strategy */}
      <Script id="google-analytics">
        {/* we pass script as string to Script component */}
        {`window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-E720JHXSJ1');`}
      </Script>
      {/* As our application grows, and we integrate it with more and more third-party services, this layout gets polluted with so many script components. So in that case, it's better to grab this piece of code for Google Analytics and put it into a separate component. */}
      <GoogleAnalyticsScript />
      <body
        className={`${geistSans.variable} ${geistMono.variable} antialiased`}
      >
        <AuthProvider>
          <NavBar />
          <main className="p-5">{children}</main>
        </AuthProvider>
      </body>
    </html>
  );
}
